"use strict";(self["webpackChunkwebmis_vue"]=self["webpackChunkwebmis_vue"]||[]).push([[76],{4517:function(e,t,s){s.d(t,{Z:function(){return B}});var l=s(6252),a=s(3577),i=s(9963);const d=["onClick"],o={class:"wm-tree_arrow"},n=["id"],c={class:"wm-tree_label"},r=["onClick"],w={key:0,class:"wm-tree_arrow"},h={key:1,class:"wm-tree_arrow_none"},m=["id"],p={class:"wm-tree_label"},u=["onClick"],k={key:0,class:"wm-tree_arrow"},_={key:1,class:"wm-tree_arrow_none"},g=["id"],f={class:"wm-tree_label"},b=["onClick"],y={key:0,class:"wm-tree_arrow"},v={key:1,class:"wm-tree_arrow_none"},C=["id"],D={class:"wm-tree_label"},Z=["onClick"],x={key:0,class:"wm-tree_arrow"},W={key:1,class:"wm-tree_arrow_none"},U=["id"],z={class:"wm-tree_label"},I=["onClick"],S={key:0,class:"wm-tree_arrow"},O={key:1,class:"wm-tree_arrow_none"},P=["id"],F={class:"wm-tree_label"};function T(e,t,s,T,H,K){const M=(0,l.up)("wm-checkbox");return(0,l.wg)(),(0,l.iD)("div",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.menus,((t,s)=>((0,l.wg)(),(0,l.iD)("div",{key:s},[(0,l._)("div",{class:"wm-tree_content",style:{"padding-left":"0px"},onClick:e=>t.show=!t.show},[(0,l._)("span",o,(0,a.zw)(t.show?"-":"+"),1),(0,l._)("span",{class:"wm-tree_checkbox",id:"wm-tree_node_"+t.id},[(0,l.Wm)(M,{checked:t.checked,onClick:(0,i.iM)((s=>e.click(t.id,t.checked=!t.checked,t.children)),["stop"])},null,8,["checked","onClick"])],8,n),(0,l._)("span",c,(0,a.zw)(t.label),1)],8,d),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.children,((s,d)=>(0,l.wy)(((0,l.wg)(),(0,l.iD)("div",{class:"wm-tree_node",key:d},[(0,l._)("div",{class:"wm-tree_content",style:{"padding-left":"16px"},onClick:e=>s.show=!s.show},[s.children&&s.children.length>0?((0,l.wg)(),(0,l.iD)("span",w,(0,a.zw)(s.show?"-":"+"),1)):((0,l.wg)(),(0,l.iD)("span",h)),(0,l._)("span",{class:"wm-tree_checkbox",id:"wm-tree_node_"+s.id},[(0,l.Wm)(M,{checked:s.checked,onClick:(0,i.iM)((t=>e.click(s.id,s.checked=!s.checked,s.children)),["stop"])},null,8,["checked","onClick"])],8,m),(0,l._)("span",p,(0,a.zw)(s.label),1)],8,r),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(s.children,((t,d)=>(0,l.wy)(((0,l.wg)(),(0,l.iD)("div",{class:"wm-tree_node",key:d},[(0,l._)("div",{class:"wm-tree_content",style:{"padding-left":"32px"},onClick:e=>t.show=!t.show},[t.children&&t.children.length>0?((0,l.wg)(),(0,l.iD)("span",k,(0,a.zw)(t.show?"-":"+"),1)):((0,l.wg)(),(0,l.iD)("span",_)),(0,l._)("span",{class:"wm-tree_checkbox",id:"wm-tree_node_"+t.id},[(0,l.Wm)(M,{checked:t.checked,onClick:(0,i.iM)((s=>e.click(t.id,t.checked=!t.checked,t.children)),["stop"])},null,8,["checked","onClick"])],8,g),(0,l._)("span",f,(0,a.zw)(t.label),1)],8,u),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.children,((s,d)=>(0,l.wy)(((0,l.wg)(),(0,l.iD)("div",{class:"wm-tree_node",key:d},[(0,l._)("div",{class:"wm-tree_content",style:{"padding-left":"48px"},onClick:e=>s.show=!s.show},[s.children&&s.children.length>0?((0,l.wg)(),(0,l.iD)("span",y,(0,a.zw)(s.show?"-":"+"),1)):((0,l.wg)(),(0,l.iD)("span",v)),(0,l._)("span",{class:"wm-tree_checkbox",id:"wm-tree_node_"+s.id},[(0,l.Wm)(M,{checked:s.checked,onClick:(0,i.iM)((t=>e.click(s.id,s.checked=!s.checked,s.children)),["stop"])},null,8,["checked","onClick"])],8,C),(0,l._)("span",D,(0,a.zw)(s.label),1)],8,b),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(s.children,((t,d)=>(0,l.wy)(((0,l.wg)(),(0,l.iD)("div",{class:"wm-tree_node",key:d},[(0,l._)("div",{class:"wm-tree_content",style:{"padding-left":"64px"},onClick:e=>t.show=!t.show},[t.children&&t.children.length>0?((0,l.wg)(),(0,l.iD)("span",x,(0,a.zw)(t.show?"-":"+"),1)):((0,l.wg)(),(0,l.iD)("span",W)),(0,l._)("span",{class:"wm-tree_checkbox",id:"wm-tree_node_"+t.id},[(0,l.Wm)(M,{checked:t.checked,onClick:(0,i.iM)((s=>e.click(t.id,t.checked=!t.checked,t.children)),["stop"])},null,8,["checked","onClick"])],8,U),(0,l._)("span",z,(0,a.zw)(t.label),1)],8,Z),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.children,((s,d)=>(0,l.wy)(((0,l.wg)(),(0,l.iD)("div",{class:"wm-tree_node",key:d},[(0,l._)("div",{class:"wm-tree_content",style:{"padding-left":"80px"},onClick:e=>s.show=!s.show},[s.children&&s.children.length>0?((0,l.wg)(),(0,l.iD)("span",S,(0,a.zw)(s.show?"-":"+"),1)):((0,l.wg)(),(0,l.iD)("span",O)),(0,l._)("span",{class:"wm-tree_checkbox",id:"wm-tree_node_"+s.id},[(0,l.Wm)(M,{checked:s.checked,onClick:(0,i.iM)((t=>e.click(s.id,s.checked=!s.checked,s.children)),["stop"])},null,8,["checked","onClick"])],8,P),(0,l._)("span",F,(0,a.zw)(s.label),1)],8,I),(0,l._)("div",{class:(0,a.C_)("wm-tree_node_"+s.id)},null,2)])),[[i.F8,t.show]]))),128))])),[[i.F8,s.show]]))),128))])),[[i.F8,t.show]]))),128))])),[[i.F8,s.show]]))),128))])),[[i.F8,t.show]]))),128))])))),128))])}var H=s(2458),K=(0,l.aZ)({name:"Tree",components:{wmCheckbox:H.Z},props:{data:{default:[]}},data(){let e=[],t=[],s="";return{menus:e,perms:s,arrs:t}},watch:{data(e){this.menus=e}},methods:{click(e,t,s){this.setCheckbox(e,t),s&&this.setChecked(t,s)},setChecked(e,t){for(let s in t)t[s].checked=e,this.setCheckbox(t[s].id,t[s].checked),t[s].children&&this.setChecked(e,t[s].children)},setCheckbox(e,t){let s=document.querySelector("#wm-tree_node_"+e+" .checked");s&&(t?s.classList.add("active"):s.classList.remove("active"))},getIds(){return this.arrs=[],this.setIds(this.menus),this.arrs},setIds(e){for(let t in e)e[t].children&&this.setIds(e[t].children),e[t].checked&&this.arrs.push(e[t].id)},getPerms(){return this.perms="",this.setPerms(this.menus),this.perms.trim()},setPerms(e){for(let t in e){let s=0;if(e[t].action)for(let l in e[t].children)e[t].children[l].checked&&(s+=e[t].children[l].perm);else e[t].children&&this.setPerms(e[t].children);e[t].checked&&(this.perms+=e[t].id+":"+s+" ")}}}}),M=s(3744);const Y=(0,M.Z)(K,[["render",T],["__scopeId","data-v-d43596e2"]]);var B=Y},9964:function(e,t,s){s.r(t),s.d(t,{default:function(){return se}});var l=s(6252),a=s(9963),i=s(3577);const d={class:"flex"},o={class:"app_ct_left"},n={class:"app_action_body flex_left"},c=(0,l._)("i",{class:"ui ui_search"},null,-1),r=[c],w={class:"app_action_list flex_left"},h={class:"app_ct_body"},m={width:"60"},p=(0,l.Uk)("ID"),u={width:"100"},k=(0,l.Uk)("名称"),_={width:"140"},g=(0,l.Uk)("创建时间"),f={width:"140"},b=(0,l.Uk)("更新时间"),y=(0,l._)("td",{width:"60",class:"tCenter"},"权限",-1),v=(0,l._)("td",null,"权限值",-1),C={width:"30",class:"checkbox wm-table_checkbox"},D={class:"tCenter"},Z=(0,l.Uk)("设置"),x=(0,l.Uk)("编辑"),W={key:2},U=(0,l._)("td",{class:"lable"},"名称",-1),z=(0,l.Uk)("添 加"),I=(0,l._)("td",{class:"lable"},"名称",-1),S=(0,l.Uk)("保 存"),O=(0,l.Uk)("是否删除已选择数据？"),P=(0,l.Uk)("彻底删除"),F=(0,l.Uk)("更 新");function T(e,t,s,c,T,H){const K=(0,l.up)("wm-input"),M=(0,l.up)("wm-search"),Y=(0,l.up)("wm-table-order"),B=(0,l.up)("wm-checkbox"),L=(0,l.up)("wm-button"),q=(0,l.up)("wm-table"),J=(0,l.up)("wm-page"),N=(0,l.up)("wm-main"),j=(0,l.up)("wm-table-form"),R=(0,l.up)("wm-dialog"),$=(0,l.up)("wm-row"),A=(0,l.up)("wm-tree");return(0,l.wg)(),(0,l.iD)("div",d,[(0,l.wy)((0,l._)("div",o,[(0,l.Wm)(M,{show:e.sea.show,"onUpdate:show":t[1]||(t[1]=t=>e.sea.show=t),"onUpdate:submit":t[2]||(t[2]=t=>e.subSea())},{default:(0,l.w5)((()=>[(0,l._)("li",null,[(0,l.Wm)(K,{value:e.sea.form.name,"onUpdate:value":t[0]||(t[0]=t=>e.sea.form.name=t),maxlength:"16",placeholder:"角色名称",clearable:""},null,8,["value"])])])),_:1},8,["show"])],512),[[a.F8,e.sea.show]]),(0,l._)("div",{class:"app_ct_right",style:(0,i.j5)({width:e.sea.show?"calc(100% - 240px)":"100%"})},[(0,l._)("div",n,[(0,l.wy)((0,l._)("div",{class:"app_action_sea",onClick:t[3]||(t[3]=t=>e.sea.show=!0)},r,512),[[a.F8,!e.sea.show]]),(0,l._)("ul",w,[e.getters.actionShow("add")?((0,l.wg)(),(0,l.iD)("li",{key:0,onClick:t[4]||(t[4]=t=>e.add.show=!0)},"添加")):(0,l.kq)("",!0),e.getters.actionShow("edit")?((0,l.wg)(),(0,l.iD)("li",{key:1,onClick:t[5]||(t[5]=t=>e.editData())},"编辑")):(0,l.kq)("",!0),e.getters.actionShow("del")?((0,l.wg)(),(0,l.iD)("li",{key:2,onClick:t[6]||(t[6]=t=>e.delData())},"删除")):(0,l.kq)("",!0)])]),(0,l._)("div",h,[(0,l.Wm)(N,null,{default:(0,l.w5)((()=>[(0,l.Wm)(q,{ref:"Table",data:e.page.list},{title:(0,l.w5)((()=>[(0,l._)("td",m,[p,(0,l.Wm)(Y,{value:e.oby.list.id,"onUpdate:value":t[7]||(t[7]=t=>e.OrderBy("id",t))},null,8,["value"])]),(0,l._)("td",u,[k,(0,l.Wm)(Y,{value:e.oby.list.name,"onUpdate:value":t[8]||(t[8]=t=>e.OrderBy("name",t))},null,8,["value"])]),(0,l._)("td",_,[g,(0,l.Wm)(Y,{value:e.oby.list.ctime,"onUpdate:value":t[9]||(t[9]=t=>e.OrderBy("ctime",t))},null,8,["value"])]),(0,l._)("td",f,[b,(0,l.Wm)(Y,{value:e.oby.list.utime,"onUpdate:value":t[10]||(t[10]=t=>e.OrderBy("utime",t))},null,8,["value"])]),y,v])),default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.page.list,((t,s)=>((0,l.wg)(),(0,l.iD)("tr",{key:s},[(0,l._)("td",C,[(0,l.Wm)(B,{value:t.id},null,8,["value"])]),(0,l._)("td",null,(0,i.zw)(t.id),1),(0,l._)("td",null,[(0,l._)("b",null,(0,i.zw)(t.name),1)]),(0,l._)("td",null,(0,i.zw)(t.ctime),1),(0,l._)("td",null,(0,i.zw)(t.utime),1),(0,l._)("td",D,[e.getters.actionShow("perm")&&!t.perm?((0,l.wg)(),(0,l.j4)(L,{key:0,type:"text",textColor:"danger",onClick:s=>e.permData(t.id,t.perm)},{default:(0,l.w5)((()=>[Z])),_:2},1032,["onClick"])):e.getters.actionShow("perm")?((0,l.wg)(),(0,l.j4)(L,{key:1,type:"text",onClick:s=>e.permData(t.id,t.perm)},{default:(0,l.w5)((()=>[x])),_:2},1032,["onClick"])):((0,l.wg)(),(0,l.iD)("span",W,"-"))]),(0,l._)("td",null,(0,i.zw)(t.perm),1)])))),128))])),_:1},8,["data"]),(0,l.Wm)(J,{page:e.page.page,limit:e.page.limit,total:e.page.total,"onUpdate:page":e.subPage},null,8,["page","limit","total","onUpdate:page"])])),_:1})])],4),(0,l.Wm)(R,{title:"添加",width:"420px",show:e.add.show,"onUpdate:show":t[13]||(t[13]=t=>e.add.show=t)},{footer:(0,l.w5)((()=>[(0,l.Wm)(L,{onClick:t[12]||(t[12]=t=>e.subAdd())},{default:(0,l.w5)((()=>[z])),_:1})])),default:(0,l.w5)((()=>[(0,l.Wm)(j,null,{default:(0,l.w5)((()=>[(0,l._)("tr",null,[U,(0,l._)("td",null,[(0,l.Wm)(K,{value:e.add.form.name,"onUpdate:value":t[11]||(t[11]=t=>e.add.form.name=t),maxlength:"16",placeholder:"角色名称"},null,8,["value"])])])])),_:1})])),_:1},8,["show"]),(0,l.Wm)(R,{title:"编辑",width:"420px",show:e.edit.show,"onUpdate:show":t[16]||(t[16]=t=>e.edit.show=t)},{footer:(0,l.w5)((()=>[(0,l.Wm)(L,{onClick:t[15]||(t[15]=t=>e.subEdit())},{default:(0,l.w5)((()=>[S])),_:1})])),default:(0,l.w5)((()=>[(0,l.Wm)(j,null,{default:(0,l.w5)((()=>[(0,l._)("tr",null,[I,(0,l._)("td",null,[(0,l.Wm)(K,{value:e.edit.form.name,"onUpdate:value":t[14]||(t[14]=t=>e.edit.form.name=t),maxlength:"16",placeholder:"角色名称"},null,8,["value"])])])])),_:1})])),_:1},8,["show"]),(0,l.Wm)(R,{title:"删除",width:"360px",show:e.del.show,"onUpdate:show":t[18]||(t[18]=t=>e.del.show=t)},{footer:(0,l.w5)((()=>[(0,l.Wm)(L,{onClick:t[17]||(t[17]=t=>e.subDel())},{default:(0,l.w5)((()=>[P])),_:1})])),default:(0,l.w5)((()=>[(0,l.Wm)($,null,{default:(0,l.w5)((()=>[O])),_:1})])),_:1},8,["show"]),(0,l.Wm)(R,{title:"权限",width:"540px",show:e.perm.show,"onUpdate:show":t[20]||(t[20]=t=>e.perm.show=t)},{footer:(0,l.w5)((()=>[(0,l.Wm)(L,{onClick:t[19]||(t[19]=t=>e.subPerm())},{default:(0,l.w5)((()=>[F])),_:1})])),default:(0,l.w5)((()=>[(0,l.Wm)(A,{ref:"perm",data:e.perm.permList},null,8,["data"])])),_:1},8,["show"])])}var H=s(3907),K=s(8907),M=s(6492),Y=s(5783),B=s(2367),L=s(8408),q=s(6448),J=s(1566),N=s(4688),j=s(4598),R=s(3098),$=s(2458),A=s(5171),E=s(7953),V=s(8650),G=s(1326),Q=s(4517),X=(0,l.aZ)({components:{wmSearch:L.Z,wmMain:q.Z,wmRow:J.Z,wmTable:N.Z,wmTableForm:j.Z,wmTableOrder:R.Z,wmCheckbox:$.Z,wmDialog:A.Z,wmInput:E.Z,wmButton:V.Z,wmPage:G.Z,wmTree:Q.Z},data(){const e=(0,H.oR)(),t=e.state,s=e.getters,l={list:[],page:1,limit:20,total:0},a={show:!1,form:{}},i={name:"",list:{id:"",name:"",ctime:"",utime:""}},d={show:!1,form:{}},o={show:!1,id:"",form:{}},n={show:!1,ids:""},c={show:!1,id:"",perm:"",permList:[]};return{state:t,getters:s,page:l,sea:a,oby:i,add:d,edit:o,del:n,perm:c}},mounted(){B.Z.getItem("token")&&this.loadData()},methods:{loadData(){this.page.list=[],this.page.total=0;const e=(0,K.Z)();(0,Y.Z)("sys_role/list",{token:B.Z.getItem("token"),page:this.page.page,limit:this.page.limit,data:JSON.stringify(this.sea.form),order:this.oby.name},(t=>{e.clear();const s=t.data;if(0!=s.code)return(0,M.Z)(s.msg);this.page.list=s.list,this.page.total=s.total}))},subPage(e){this.page.page=e,this.loadData()},subSea(){this.page.page=1,this.loadData()},OrderBy(e,t){for(let s in this.oby.list)this.oby.list[s]=s==e?t:"";this.oby.name=t?e+" "+t:"",this.loadData()},subAdd(){this.add.show=!1;const e=JSON.stringify(this.add.form),t=(0,K.Z)();(0,Y.Z)("sys_role/add",{token:B.Z.getItem("token"),data:e},(e=>{t.clear();const s=e.data;return 0===s.code&&this.loadData(),(0,M.Z)(s.msg)}))},editData(){const e=this.$refs.Table,t=e.getRow();if(!t)return(0,M.Z)("请选择数据!");this.edit.show=!0,this.edit.id=t.id,this.edit.form.name=t.name},subEdit(){this.edit.show=!1;const e=this.edit.id,t=JSON.stringify(this.edit.form),s=(0,K.Z)();(0,Y.Z)("sys_role/edit",{token:B.Z.getItem("token"),id:e,data:t},(e=>{s.clear();const t=e.data;return 0===t.code&&this.loadData(),(0,M.Z)(t.msg)}))},delData(){const e=this.$refs.Table,t=e.getVals();if(!t)return(0,M.Z)("请选择数据!");this.del.show=!0,this.del.ids=JSON.stringify(t)},subDel(){this.del.show=!1;const e=(0,K.Z)();(0,Y.Z)("sys_role/del",{token:B.Z.getItem("token"),data:this.del.ids},(t=>{e.clear();const s=t.data;return 0===s.code&&this.loadData(),(0,M.Z)(s.msg)}))},permData(e,t){this.perm.show=!0,this.perm.id=e;const s=(0,K.Z)();(0,Y.Z)("sys_role/permList",{token:B.Z.getItem("token"),perm:t||""},(e=>{s.clear();const t=e.data;0===t.code?this.perm.permList=t.list:(0,M.Z)(t.msg)}))},subPerm(){this.perm.show=!1;const e=this.$refs.perm,t=(0,K.Z)();(0,Y.Z)("sys_role/perm",{token:B.Z.getItem("token"),id:this.perm.id,perm:e.getPerms()},(e=>{t.clear();const s=e.data;return 0===s.code&&this.loadData(),(0,M.Z)(s.msg)}))}}}),ee=s(3744);const te=(0,ee.Z)(X,[["render",T]]);var se=te}}]);