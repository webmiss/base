(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-01ea75bc"],{"34c9":function(t,e,o){},"3cb1":function(t,e,o){"use strict";o.r(e);o("b0c0");var i=o("7a23"),n=Object(i["hb"])("data-v-54c634f4");Object(i["I"])("data-v-54c634f4");var s=Object(i["o"])("td",{width:"30"},"ID",-1),c=Object(i["o"])("td",{width:"90"},"房间ID",-1),r=Object(i["o"])("td",{width:"120"},"名称",-1),a=Object(i["o"])("td",{width:"80"},"主播",-1),l=Object(i["o"])("td",{width:"80"},"观众",-1),u=Object(i["o"])("td",null,"信息",-1),h=Object(i["n"])("主播"),d=Object(i["n"])("观众"),f=Object(i["o"])("td",null,null,-1),m={class:"player_video"},b={class:"player_msg"},p={class:"player_msg_list",ref:"MsgList"},g={class:"flex"},j=Object(i["o"])("div",{class:"img"},null,-1),O={class:"info"},v={class:"content"},_={key:0,class:"player_tools"},w=Object(i["o"])("div",{id:"playerView"},null,-1),y=Object(i["o"])("div",{class:"player_emoji"}," 表情 ",-1),T={class:"player_send flex"},M={class:"player_send_msg"},S={key:0,class:"player_send_login"},k=Object(i["n"])('需要" '),I=Object(i["n"])(' "才能发言!'),C=Object(i["n"])("发送");Object(i["G"])();var P=n((function(t,e,o,P,E,x){var D=Object(i["O"])("wm-table-title"),R=Object(i["O"])("wm-button"),G=Object(i["O"])("wm-table-tr"),L=Object(i["O"])("wm-table"),V=Object(i["O"])("wm-input"),A=Object(i["O"])("wm-dialog"),Y=Object(i["O"])("wm-main");return Object(i["F"])(),Object(i["j"])(Y,null,{default:n((function(){return[Object(i["o"])(L,{class:"table",ref:"Table",data:t.page.list},{default:n((function(){return[Object(i["o"])(D,null,{default:n((function(){return[s,c,r,a,l,u]})),_:1}),(Object(i["F"])(!0),Object(i["j"])(i["b"],null,Object(i["M"])(t.page.list,(function(e,o){return Object(i["F"])(),Object(i["j"])(G,{key:o,value:e.id+""},{default:n((function(){return[Object(i["o"])("td",null,Object(i["S"])(e.id),1),Object(i["o"])("td",null,Object(i["S"])("room_"+e.id),1),Object(i["o"])("td",null,Object(i["S"])(e.name),1),Object(i["o"])("td",null,[Object(i["o"])(R,{type:"danger",height:"32px",onClick:function(o){return t.RoomJoin("anchor",e.id,e.group_id)}},{default:n((function(){return[h]})),_:2},1032,["onClick"])]),Object(i["o"])("td",null,[Object(i["o"])(R,{type:"info",height:"32px",onClick:function(o){return t.RoomJoin("audience",e.id,e.group_id)}},{default:n((function(){return[d]})),_:2},1032,["onClick"])]),f]})),_:2},1032,["value"])})),128))]})),_:1},8,["data"]),Object(i["o"])(A,{title:t.room.title,width:"640px",show:t.room.show,"onUpdate:close":e[8]||(e[8]=function(e){return t.clickClose(e)}),isFooter:!1},{default:n((function(){return[Object(i["o"])("div",m,[Object(i["o"])("div",b,[Object(i["o"])("div",{class:"player_msg_wrapper",ref:"MsgBox",onScroll:e[1]||(e[1]=function(){return t.onScroll&&t.onScroll.apply(t,arguments)})},[Object(i["o"])("div",p,[(Object(i["F"])(!0),Object(i["j"])(i["b"],null,Object(i["M"])(t.form.lists,(function(t,e){return Object(i["F"])(),Object(i["j"])("div",{class:"player_msg_box",key:e},[Object(i["o"])("div",g,[j,Object(i["o"])("div",O,"ID:"+Object(i["S"])(t.uid),1)]),Object(i["o"])("div",v,Object(i["S"])(t.text),1)])})),128))],512)],544)]),"anchor"==t.room.role?(Object(i["F"])(),Object(i["j"])("ul",_,[Object(i["o"])("li",{class:t.tools.camera?"active":"",onClick:e[2]||(e[2]=function(e){return t.setCamera(!t.tools.camera)})},"视频",2),Object(i["o"])("li",{class:t.tools.microphone?"active":"",onClick:e[3]||(e[3]=function(e){return t.setMicrophone(!t.tools.microphone)})},"麦风",2),Object(i["o"])("li",{class:t.tools.push?"active":"",onClick:e[4]||(e[4]=function(e){return t.setPush(!t.tools.push)})},"推流",2)])):Object(i["k"])("",!0),w]),y,Object(i["o"])("div",T,[Object(i["o"])("div",M,[t.form.login?(Object(i["F"])(),Object(i["j"])(V,{key:1,value:t.form.content,"onUpdate:value":e[6]||(e[6]=function(e){return t.form.content=e}),placeholder:"消息内容"},null,8,["value"])):(Object(i["F"])(),Object(i["j"])("div",S,[k,Object(i["o"])("b",{onClick:e[5]||(e[5]=function(e){return t.roomLogin()})},"登录"),I]))]),Object(i["o"])(R,{height:"40px",onClick:e[7]||(e[7]=function(e){return t.SendSub()})},{default:n((function(){return[C]})),_:1})])]})),_:1},8,["title","show"])]})),_:1})})),E=(o("99af"),o("5502")),x=o("bb82"),D=o("7ab7"),R=o("c2b4"),G=o("bb2f"),L=o("b288"),V=o("0dd2"),A=o("1125"),Y=o("36e0"),F=o("bf46"),J=o("edb5"),N=o("903b"),B=Object(i["p"])({components:{wmMain:L["a"],wmTable:V["a"],wmTableTitle:A["a"],wmTableTr:Y["a"],wmDialog:F["a"],wmInput:J["a"],wmButton:N["a"]},data:function(){var t=Object(E["b"])(),e=t.state,o={list:[],page:1,limit:10,total:0},i={},n={show:!1,title:"",id:"",groupid:"",role:""},s=null,c=null,r=null,a=null,l={login:!1,content:"",isScroll:!0,lists:[]},u={camera:!0,microphone:!0,push:!1};return{state:e,page:o,uinfo:i,room:n,pusher:s,player:c,tim:r,im:a,form:l,tools:u}},mounted:function(){x["a"].getItem("token")&&this.loadData()},beforeUnmount:function(){this.pusher=null},methods:{loadData:function(){var t=this;Object(G["a"])(["/tweblive/trtc.js","/tweblive/tim-js.js"]),setTimeout((function(){Object(G["a"])(["/tweblive/tweblive.js"])}),300),Object(R["a"])("/demo/tweblive/list",{token:x["a"].getItem("token")},(function(e){var o=e.data;if(0!=o.code)return Object(D["a"])(o.msg);t.page.list=o.list})),Object(R["a"])("/demo/tweblive/userInfo",{token:x["a"].getItem("token")},(function(e){var o=e.data;if(0!=o.code)return Object(D["a"])(o.msg);t.uinfo=o.uinfo}))},RoomJoin:function(t,e,o){var i=this;this.room.show=!0,this.room.id=e,this.room.groupid=o,this.room.role=t;var n=this.state.uInfo.uid;this.room.title="anchor"==t?"主播ID: "+n:"观众ID: "+n,"anchor"!=t||this.pusher||(this.pusher=TWebLive.createPusher({userID:n,useStringRoomId:!0}),this.pusher.setLogLevel(4)),"anchor"==t&&(this.setCamera(!0),this.setMicrophone(!0)),"anchor"==t||this.player||(this.player=TWebLive.createPlayer(),this.player.setLogLevel(4)),this.renderView(),this.tim||(this.tim=TIM.create({SDKAppID:this.uinfo.sdk_app_id}),this.tim.setLogLevel(4),this.tim.on(TIM.EVENT.SDK_READY,(function(){i.form.login=!0})),this.tim.on(TIM.EVENT.MESSAGE_RECEIVED,this.roomMassage)),this.roomJoin()},roomJoin:function(){var t=this;this.tim.joinGroup({groupID:this.room.groupid,type:TIM.TYPES.GRP_AVCHATROOM}).then((function(e){var o=e.data.status;console.log("[直播群] 加入:",o,t.room.groupid)})).catch((function(t){console.log("[直播群] 加入:","失败!")}))},roomLogin:function(){var t=this,e=this.uinfo.user_id,o=this.uinfo.user_sig;this.tim.login({userID:e,userSig:o}).then((function(){console.log("[登录]:",e,o),t.tim.quitGroup(t.room.groupid).then((function(e){console.log("[直播群] 退出:","成功"),t.roomJoin()}))})).catch((function(t){console.log("[登录]:",t)}))},roomMassage:function(t){for(var e,o=t.data.length,i=0;i<o;i++)switch(e=t.data[i],e.type){case TIM.TYPES.MSG_TEXT:this.msgText(e);break;case TIM.TYPES.MSG_CUSTOM:this.msgCustom(e);break;case TIM.TYPES.MSG_GRP_TIP:this.msgGroupTip(e);break;case TIM.TYPES.MSG_GRP_SYS_NOTICE:this.msgSystemNotice(e);break;default:break}},msgText:function(t){console.log("消息-文本:",t),this.msgPush({uid:t.from,text:t.payload.text})},msgCustom:function(t){console.log("消息-自定义:",t)},msgGroupTip:function(t){console.log("消息-进群&退群:",t)},msgSystemNotice:function(t){console.log("消息-系统通知:",t)},SendSub:function(){var t=this.form.content;this.sendMsg({text:t})},sendMsg:function(t){var e=this,o=this.tim.createTextMessage({to:this.room.groupid,conversationType:TIM.TYPES.CONV_GROUP,priority:TIM.TYPES.MSG_PRIORITY_NORMAL,payload:t});this.tim.sendMessage(o).then((function(t){console.log("[发送消息]:",t);var o=t.data.message;e.msgPush({uid:e.uinfo.user_id,text:o.payload.text}),e.form.content=""})).catch((function(t){console.log("[发送消息]:",t)}))},onScroll:function(t){var e=t.target.scrollTop,o=this.$refs.MsgBox,i=this.$refs.MsgList;i.clientHeight-o.clientHeight-e<10?this.form.isScroll=!0:this.form.isScroll=!1},msgPush:function(t){var e=this;this.form.lists.push(t),this.form.isScroll&&setTimeout((function(){var t=e.$refs.MsgBox,o=e.$refs.MsgList;t.scrollTop=o.scrollHeight}),100)},renderView:function(){if("anchor"==this.room.role)this.pusher.setRenderView({elementID:"playerView",audio:!0,video:{width:480,height:280,frameRate:10,bitrate:400}}).then((function(){console.log("[本地流]:","成功")})).catch((function(t){console.log("[本地流]:",t)}));else{this.player.setRenderView({elementID:"playerView"});var t=this.room.id,e=this.uinfo.sdk_app_id,o=this.uinfo.user_id,i=this.uinfo.user_sig,n="room://sdkappid=".concat(e,"&roomid=").concat(t,"&userid=").concat(o,"&usersig=").concat(i);this.player.startPlay(n).then((function(){console.log("[远程流]:","成功")})).catch((function(t){console.log("[远程流]:",t)}))}},clickClose:function(t){this.room.show=t,t||("anchor"==this.room.role?(this.tools.camera&&this.setCamera(!1),this.tools.setMicrophone&&this.setMicrophone(!1),this.tools.push&&this.setPush(!1)):this.player.stopPlay())},setCamera:function(t){this.tools.camera=t,t?(console.log("[摄像头]:","打开"),this.pusher.startCamera()):(console.log("[摄像头]:","关闭"),this.pusher.stopCamera())},setMicrophone:function(t){this.tools.microphone=t,t?(console.log("[麦克风]:","打开"),this.pusher.startMicrophone()):(console.log("[麦克风]:","关闭"),this.pusher.stopMicrophone())},setPush:function(t){if("anchor"!=this.room.role)return Object(D["a"])("只有主播才能推流!");if(this.tools.push=t,t){var e=this.room.id,o="stream_"+this.room.id,i=this.uinfo.sdk_app_id,n=this.uinfo.user_id,s=this.uinfo.user_sig,c=this.uinfo.live_domain_name,r="room://sdkappid=".concat(i,"&roomid=").concat(e,"&userid=").concat(n,"&usersig=").concat(s,"&livedomainname=").concat(c,"&streamid=").concat(o);this.pusher.startPush(r).then((function(){console.log("[推流]:","成功")})).catch((function(t){console.log("[推流]:",t)}))}else this.pusher.stopPush().then((function(){console.log("[停止推流]:","成功")})).catch((function(t){console.log("[停止推流]:",t)}))}}});o("6dbb"),o("7c98");B.render=P,B.__scopeId="data-v-54c634f4";e["default"]=B},"6dbb":function(t,e,o){"use strict";o("a120")},"7c98":function(t,e,o){"use strict";o("34c9")},"99af":function(t,e,o){"use strict";var i=o("23e7"),n=o("d039"),s=o("e8b5"),c=o("861d"),r=o("7b0b"),a=o("50c4"),l=o("8418"),u=o("65f0"),h=o("1dde"),d=o("b622"),f=o("2d00"),m=d("isConcatSpreadable"),b=9007199254740991,p="Maximum allowed index exceeded",g=f>=51||!n((function(){var t=[];return t[m]=!1,t.concat()[0]!==t})),j=h("concat"),O=function(t){if(!c(t))return!1;var e=t[m];return void 0!==e?!!e:s(t)},v=!g||!j;i({target:"Array",proto:!0,forced:v},{concat:function(t){var e,o,i,n,s,c=r(this),h=u(c,0),d=0;for(e=-1,i=arguments.length;e<i;e++)if(s=-1===e?c:arguments[e],O(s)){if(n=a(s.length),d+n>b)throw TypeError(p);for(o=0;o<n;o++,d++)o in s&&l(h,d,s[o])}else{if(d>=b)throw TypeError(p);l(h,d++,s)}return h.length=d,h}})},a120:function(t,e,o){},bb2f:function(t,e,o){"use strict";var i=o("b85c"),n=(o("1276"),o("ac1f"),function(t,e){var o,n="js"==e||/js$/i.test(t),s=document.getElementsByTagName(n?"script":"link"),c=Object(i["a"])(s);try{for(c.s();!(o=c.n()).done;){var r=o.value,a=n?"src":"href";if(-1!=r[a].indexOf(t))return!0}}catch(l){c.e(l)}finally{c.f()}return!1});e["a"]=function(t,e,o){var s=[],c=!1;e=e||!1;var r,a=Object(i["a"])(t);try{for(a.s();!(r=a.n()).done;){var l=r.value;if(c=n(l,o),e&&(c=!1),s=l.split("."),"js"==s[s.length-1]||"js"==o){if(!c){var u=document.createElement("script");u.setAttribute("src",l),document.body.appendChild(u)}}else if(("css"==s[s.length-1]||"css"==o)&&!c){var h=document.createElement("link");h.setAttribute("rel","stylesheet"),h.setAttribute("href",l),document.body.appendChild(h)}}}catch(d){a.e(d)}finally{a.f()}}}}]);