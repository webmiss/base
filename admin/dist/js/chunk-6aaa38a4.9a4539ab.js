(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6aaa38a4"],{"0f54":function(t,e,o){"use strict";o("ee86")},"3cb1":function(t,e,o){"use strict";o.r(e);o("b0c0");var n=o("7a23"),i=Object(n["o"])("td",{width:"30"},"ID",-1),r=Object(n["o"])("td",{width:"90"},"房间ID",-1),c=Object(n["o"])("td",{width:"120"},"名称",-1),a=Object(n["o"])("td",{width:"80"},"主播",-1),s=Object(n["o"])("td",{width:"80"},"观众",-1),u=Object(n["o"])("td",null,"信息",-1),l=Object(n["n"])("主播"),d=Object(n["n"])("观众"),h=Object(n["o"])("td",null,null,-1),b=Object(n["o"])("div",{id:"playerView",style:{width:"100%",height:"auto"}},null,-1),f=Object(n["n"])("推送");function m(t,e,o,m,p,O){var j=Object(n["O"])("wm-table-title"),g=Object(n["O"])("wm-button"),w=Object(n["O"])("wm-table-tr"),T=Object(n["O"])("wm-table"),v=Object(n["O"])("wm-row"),_=Object(n["O"])("wm-dialog"),y=Object(n["O"])("wm-main");return Object(n["F"])(),Object(n["j"])(y,null,{default:Object(n["db"])((function(){return[Object(n["o"])(T,{class:"table",ref:"Table",data:t.page.list},{default:Object(n["db"])((function(){return[Object(n["o"])(j,null,{default:Object(n["db"])((function(){return[i,r,c,a,s,u]})),_:1}),(Object(n["F"])(!0),Object(n["j"])(n["b"],null,Object(n["M"])(t.page.list,(function(e,o){return Object(n["F"])(),Object(n["j"])(w,{key:o,value:e.id+""},{default:Object(n["db"])((function(){return[Object(n["o"])("td",null,Object(n["S"])(e.id),1),Object(n["o"])("td",null,Object(n["S"])("room_"+e.id),1),Object(n["o"])("td",null,Object(n["S"])(e.name),1),Object(n["o"])("td",null,[Object(n["o"])(g,{type:"danger",height:"32px",onClick:function(o){return t.RoomJoin("anchor",e.id,e.group_id)}},{default:Object(n["db"])((function(){return[l]})),_:2},1032,["onClick"])]),Object(n["o"])("td",null,[Object(n["o"])(g,{type:"info",height:"32px",onClick:function(o){return t.RoomJoin("audience",e.id,e.group_id)}},{default:Object(n["db"])((function(){return[d]})),_:2},1032,["onClick"])]),h]})),_:2},1032,["value"])})),128))]})),_:1},8,["data"]),Object(n["o"])(_,{title:t.room.title,width:"640px",show:t.room.show,"onUpdate:close":e[2]||(e[2]=function(e){return t.pusherClose(e)})},{footer:Object(n["db"])((function(){return[Object(n["o"])(g,{onClick:e[1]||(e[1]=function(e){return t.pusherPush()})},{default:Object(n["db"])((function(){return[f]})),_:1})]})),default:Object(n["db"])((function(){return[Object(n["o"])(v,null,{default:Object(n["db"])((function(){return[b]})),_:1})]})),_:1},8,["title","show"])]})),_:1})}o("99af");var p=o("5502"),O=o("bb82"),j=o("7ab7"),g=o("c2b4"),w=o("bb2f"),T=o("b288"),v=o("0dd2"),_=o("1125"),y=o("36e0"),I=o("903b"),M=o("bf46"),S=o("b72b"),k=Object(n["p"])({components:{wmMain:T["a"],wmTable:v["a"],wmTableTitle:_["a"],wmTableTr:y["a"],wmButton:I["a"],wmDialog:M["a"],wmRow:S["a"]},data:function(){var t=Object(p["b"])(),e=t.state,o={list:[],page:1,limit:10,total:0},n={},i={show:!1,title:"",id:"",groupid:"",role:""},r=null,c=null,a=null,s=null;return{state:e,page:o,uinfo:n,room:i,pusher:r,player:c,tim:a,im:s}},mounted:function(){O["a"].getItem("token")&&this.loadData()},beforeUnmount:function(){this.pusher=null},methods:{loadData:function(){var t=this;Object(w["a"])(["/tweblive/trtc.js"]),setTimeout((function(){Object(w["a"])(["/tweblive/tim-js.js"])}),300),setTimeout((function(){Object(w["a"])(["/tweblive/tweblive.js"])}),600),this.page.list=[{id:"1",group_id:"@TGS#aRHBAOFHK",name:"xxx直播"},{id:"2",group_id:"@TGS#aRHBAOFHK",name:"xxx直播"}],Object(g["a"])("/demo/tweblive/userInfo",{token:O["a"].getItem("token")},(function(e){var o=e.data;if(0!=o.code)return Object(j["a"])(o.msg);t.uinfo=o.uinfo}))},RoomJoin:function(t,e,o){this.room.show=!0,this.room.id=e,this.room.groupid=o,this.room.role=t;var n=this.state.uInfo.uid;this.room.title="anchor"==t?"主播ID: "+n:"观众ID: "+n,"anchor"!=t||this.pusher||(this.pusher=TWebLive.createPusher({userID:n,useStringRoomId:!0})),"anchor"==t||this.player||(this.player=TWebLive.createPlayer()),this.renderView(),this.tim||(this.tim=TIM.create({SDKAppID:this.uinfo.sdk_app_id}),this.tim.on(TIM.EVENT.SDK_READY,this.roomReady),this.tim.on(TIM.EVENT.MESSAGE_RECEIVED,this.roomMassage)),this.roomJoin()},roomJoin:function(){var t=this;this.tim.joinGroup({groupID:this.room.groupid,type:TIM.TYPES.GRP_AVCHATROOM}).then((function(e){var o=e.data.status;console.log("直播间-加入:",o),"anchor"==t.room.role||console.log("观众:","游客身份!")})).catch((function(t){console.log("直播间-加入:","失败!")}))},roomReady:function(t){},roomMassage:function(t){for(var e,o=t.data.length,n=0;n<o;n++)switch(e=t.data[n],e.type){case TIM.TYPES.MSG_TEXT:this.msgText(e);break;case TIM.TYPES.MSG_CUSTOM:this.msgCustom(e);break;case TIM.TYPES.MSG_GRP_TIP:this.msgGroupTip(e);break;case TIM.TYPES.MSG_GRP_SYS_NOTICE:this.msgSystemNotice(e);break;default:break}},msgText:function(t){console.log("消息-文本:",t)},msgCustom:function(t){console.log("消息-自定义:",t)},msgGroupTip:function(t){console.log("消息-进群&退群:",t)},msgSystemNotice:function(t){console.log("消息-系统通知:",t)},sendMsg:function(){var t=this.tim.createTextMessage({to:this.room.groupid,conversationType:TIM.TYPES.CONV_GROUP,priority:TIM.TYPES.MSG_PRIORITY_NORMAL,payload:{text:"Hello world!"}});this.tim.sendMessage(t).then((function(t){console.log("发送消息:",t)})).catch((function(t){console.log("发送消息:",t)}))},renderView:function(){if("anchor"==this.room.role)this.pusher.setRenderView({elementID:"playerView",audio:!0,video:{width:480,height:280,frameRate:10,bitrate:400}}).then((function(){console.log("视频流: 创建成功!")})).catch((function(t){console.log("视频流:",t)}));else{this.player.setRenderView({elementID:"playerView"});var t=this.room.id,e=this.uinfo.sdk_app_id,o=this.uinfo.user_id,n=this.uinfo.user_sig,i="room://sdkappid=".concat(e,"&roomid=").concat(t,"&userid=").concat(o,"&usersig=").concat(n);this.player.startPlay(i).then((function(){console.log("远程拉流: 成功!")})).catch((function(t){console.log("远程拉流:",t)}))}},pusherPush:function(){if("anchor"!=this.room.role)return Object(j["a"])("只有主播才能推流!");var t=this.room.id,e="stream_"+this.room.id,o=this.uinfo.sdk_app_id,n=this.uinfo.user_id,i=this.uinfo.user_sig,r=this.uinfo.live_domain_name,c="room://sdkappid=".concat(o,"&roomid=").concat(t,"&userid=").concat(n,"&usersig=").concat(i,"&livedomainname=").concat(r,"&streamid=").concat(e);this.pusher.startPush(c).then((function(){console.log("远程推流: 成功!")})).catch((function(t){console.log("远程推流:",t)}))},pusherClose:function(t){var e=this;this.room.show=t,t||("anchor"==this.room.role?this.pusher.stopPush().then((function(){e.pusher.stopCamera(),e.pusher.stopMicrophone(),console.log("停止推流: 成功!")})).catch((function(t){console.log("停止推流:",t)})):this.player.stopPlay())}}});o("0f54");k.render=m;e["default"]=k},"99af":function(t,e,o){"use strict";var n=o("23e7"),i=o("d039"),r=o("e8b5"),c=o("861d"),a=o("7b0b"),s=o("50c4"),u=o("8418"),l=o("65f0"),d=o("1dde"),h=o("b622"),b=o("2d00"),f=h("isConcatSpreadable"),m=9007199254740991,p="Maximum allowed index exceeded",O=b>=51||!i((function(){var t=[];return t[f]=!1,t.concat()[0]!==t})),j=d("concat"),g=function(t){if(!c(t))return!1;var e=t[f];return void 0!==e?!!e:r(t)},w=!O||!j;n({target:"Array",proto:!0,forced:w},{concat:function(t){var e,o,n,i,r,c=a(this),d=l(c,0),h=0;for(e=-1,n=arguments.length;e<n;e++)if(r=-1===e?c:arguments[e],g(r)){if(i=s(r.length),h+i>m)throw TypeError(p);for(o=0;o<i;o++,h++)o in r&&u(d,h,r[o])}else{if(h>=m)throw TypeError(p);u(d,h++,r)}return d.length=h,d}})},bb2f:function(t,e,o){"use strict";var n=o("b85c"),i=(o("1276"),o("ac1f"),function(t,e){var o,i="js"==e||/js$/i.test(t),r=document.getElementsByTagName(i?"script":"link"),c=Object(n["a"])(r);try{for(c.s();!(o=c.n()).done;){var a=o.value,s=i?"src":"href";if(-1!=a[s].indexOf(t))return!0}}catch(u){c.e(u)}finally{c.f()}return!1});e["a"]=function(t,e,o){var r=[],c=!1;e=e||!1;var a,s=Object(n["a"])(t);try{for(s.s();!(a=s.n()).done;){var u=a.value;if(c=i(u,o),e&&(c=!1),r=u.split("."),"js"==r[r.length-1]||"js"==o){if(!c){var l=document.createElement("script");l.setAttribute("src",u),document.body.appendChild(l)}}else if(("css"==r[r.length-1]||"css"==o)&&!c){var d=document.createElement("link");d.setAttribute("rel","stylesheet"),d.setAttribute("href",u),document.body.appendChild(d)}}}catch(h){s.e(h)}finally{s.f()}}},ee86:function(t,e,o){}}]);