"use strict";(self["webpackChunkwebmis_vue"]=self["webpackChunkwebmis_vue"]||[]).push([[560],{1126:function(e,t,l){l.d(t,{Z:function(){return q}});var s=l(6252),a=l(3577),i=l(9963);const d=["onClick"],c={class:"wm-tree_arrow"},o=["id"],n={class:"wm-tree_label"},r=["onClick"],w={key:0,class:"wm-tree_arrow"},h={key:1,class:"wm-tree_arrow_none"},m=["id"],p={class:"wm-tree_label"},k=["onClick"],_={key:0,class:"wm-tree_arrow"},u={key:1,class:"wm-tree_arrow_none"},g=["id"],f={class:"wm-tree_label"},b=["onClick"],v={key:0,class:"wm-tree_arrow"},C={key:1,class:"wm-tree_arrow_none"},D=["id"],y={class:"wm-tree_label"},Z=["onClick"],x={key:0,class:"wm-tree_arrow"},W={key:1,class:"wm-tree_arrow_none"},U=["id"],z={class:"wm-tree_label"},S=["onClick"],I={key:0,class:"wm-tree_arrow"},P={key:1,class:"wm-tree_arrow_none"},T=["id"],F={class:"wm-tree_label"};function H(e,t,l,H,K,Y){const L=(0,s.up)("wm-checkbox");return(0,s.wg)(),(0,s.iD)("div",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.menus,((t,l)=>((0,s.wg)(),(0,s.iD)("div",{key:l},[(0,s._)("div",{class:"wm-tree_content",style:{"padding-left":"0px"},onClick:e=>t.show=!t.show},[(0,s._)("span",c,(0,a.zw)(t.show?"-":"+"),1),(0,s._)("span",{class:"wm-tree_checkbox",id:"wm-tree_node_"+t.id},[(0,s.Wm)(L,{checked:t.checked,onClick:l=>e.click(t.id,t.checked=!t.checked,t.children),disclick:!0},null,8,["checked","onClick"])],8,o),(0,s._)("span",n,(0,a.zw)(t.label),1)],8,d),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(t.children,((l,d)=>(0,s.wy)(((0,s.wg)(),(0,s.iD)("div",{class:"wm-tree_node",key:d},[(0,s._)("div",{class:"wm-tree_content",style:{"padding-left":"16px"},onClick:e=>l.show=!l.show},[l.children&&l.children.length>0?((0,s.wg)(),(0,s.iD)("span",w,(0,a.zw)(l.show?"-":"+"),1)):((0,s.wg)(),(0,s.iD)("span",h)),(0,s._)("span",{class:"wm-tree_checkbox",id:"wm-tree_node_"+l.id},[(0,s.Wm)(L,{checked:l.checked,onClick:t=>e.click(l.id,l.checked=!l.checked,l.children),disclick:!0},null,8,["checked","onClick"])],8,m),(0,s._)("span",p,(0,a.zw)(l.label),1)],8,r),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(l.children,((t,d)=>(0,s.wy)(((0,s.wg)(),(0,s.iD)("div",{class:"wm-tree_node",key:d},[(0,s._)("div",{class:"wm-tree_content",style:{"padding-left":"32px"},onClick:e=>t.show=!t.show},[t.children&&t.children.length>0?((0,s.wg)(),(0,s.iD)("span",_,(0,a.zw)(t.show?"-":"+"),1)):((0,s.wg)(),(0,s.iD)("span",u)),(0,s._)("span",{class:"wm-tree_checkbox",id:"wm-tree_node_"+t.id},[(0,s.Wm)(L,{checked:t.checked,onClick:l=>e.click(t.id,t.checked=!t.checked,t.children),disclick:!0},null,8,["checked","onClick"])],8,g),(0,s._)("span",f,(0,a.zw)(t.label),1)],8,k),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(t.children,((l,d)=>(0,s.wy)(((0,s.wg)(),(0,s.iD)("div",{class:"wm-tree_node",key:d},[(0,s._)("div",{class:"wm-tree_content",style:{"padding-left":"48px"},onClick:e=>l.show=!l.show},[l.children&&l.children.length>0?((0,s.wg)(),(0,s.iD)("span",v,(0,a.zw)(l.show?"-":"+"),1)):((0,s.wg)(),(0,s.iD)("span",C)),(0,s._)("span",{class:"wm-tree_checkbox",id:"wm-tree_node_"+l.id},[(0,s.Wm)(L,{checked:l.checked,onClick:t=>e.click(l.id,l.checked=!l.checked,l.children),disclick:!0},null,8,["checked","onClick"])],8,D),(0,s._)("span",y,(0,a.zw)(l.label),1)],8,b),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(l.children,((t,d)=>(0,s.wy)(((0,s.wg)(),(0,s.iD)("div",{class:"wm-tree_node",key:d},[(0,s._)("div",{class:"wm-tree_content",style:{"padding-left":"64px"},onClick:e=>t.show=!t.show},[t.children&&t.children.length>0?((0,s.wg)(),(0,s.iD)("span",x,(0,a.zw)(t.show?"-":"+"),1)):((0,s.wg)(),(0,s.iD)("span",W)),(0,s._)("span",{class:"wm-tree_checkbox",id:"wm-tree_node_"+t.id},[(0,s.Wm)(L,{checked:t.checked,onClick:l=>e.click(t.id,t.checked=!t.checked,t.children),disclick:!0},null,8,["checked","onClick"])],8,U),(0,s._)("span",z,(0,a.zw)(t.label),1)],8,Z),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(t.children,((l,d)=>(0,s.wy)(((0,s.wg)(),(0,s.iD)("div",{class:"wm-tree_node",key:d},[(0,s._)("div",{class:"wm-tree_content",style:{"padding-left":"80px"},onClick:e=>l.show=!l.show},[l.children&&l.children.length>0?((0,s.wg)(),(0,s.iD)("span",I,(0,a.zw)(l.show?"-":"+"),1)):((0,s.wg)(),(0,s.iD)("span",P)),(0,s._)("span",{class:"wm-tree_checkbox",id:"wm-tree_node_"+l.id},[(0,s.Wm)(L,{checked:l.checked,onClick:t=>e.click(l.id,l.checked=!l.checked,l.children),disclick:!0},null,8,["checked","onClick"])],8,T),(0,s._)("span",F,(0,a.zw)(l.label),1)],8,S),(0,s._)("div",{class:(0,a.C_)("wm-tree_node_"+l.id)},null,2)])),[[i.F8,t.show]]))),128))])),[[i.F8,l.show]]))),128))])),[[i.F8,t.show]]))),128))])),[[i.F8,l.show]]))),128))])),[[i.F8,t.show]]))),128))])))),128))])}var K=l(4480),Y=(0,s.aZ)({name:"Tree",components:{wmCheckbox:K.Z},props:{data:{default:[]}},data(){let e=[],t=[],l="";return{menus:e,perms:l,arrs:t}},watch:{data(e){this.menus=e}},methods:{click(e,t,l){this.setCheckbox(e,t),l&&this.setChecked(t,l)},setChecked(e,t){for(let l in t)t[l].checked=e,this.setCheckbox(t[l].id,t[l].checked),t[l].children&&this.setChecked(e,t[l].children)},setCheckbox(e,t){let l=document.querySelector("#wm-tree_node_"+e+" div.checked");l&&(t?l.classList.add("active"):l.classList.remove("active"))},getIds(){return this.arrs=[],this.setIds(this.menus),this.arrs},setIds(e){for(let t in e)e[t].children&&this.setIds(e[t].children),e[t].checked&&this.arrs.push(e[t].id)},getPerms(){return this.perms="",this.setPerms(this.menus),this.perms.trim()},setPerms(e){for(let t in e){let l=0;if(e[t].action)for(let s in e[t].children)e[t].children[s].checked&&(l+=e[t].children[s].perm);else e[t].children&&this.setPerms(e[t].children);e[t].checked&&(this.perms+=e[t].id+":"+l+" ")}}}}),L=l(3744);const j=(0,L.Z)(Y,[["render",H],["__scopeId","data-v-5684fac0"]]);var q=j},7334:function(e,t,l){l.r(t),l.d(t,{default:function(){return te}});var s=l(6252),a=l(9963),i=l(3577);const d=e=>((0,s.dD)("data-v-20a0c673"),e=e(),(0,s.Cn)(),e),c={class:"flex"},o={class:"app_ct_left"},n={class:"app_sea_title flex"},r=d((()=>(0,s._)("h2",null,"搜索",-1))),w=d((()=>(0,s._)("i",{class:"ui ui_left"},null,-1))),h=[w],m={class:"app_sea_form"},p={class:"app_sea_sub"},k=(0,s.Uk)("搜 索"),_={class:"app_action_body flex_left"},u=d((()=>(0,s._)("i",{class:"ui ui_search"},null,-1))),g=[u],f={class:"app_action_list flex_left"},b={class:"app_ct_body"},v=d((()=>(0,s._)("td",{width:"60"},"ID",-1))),C=d((()=>(0,s._)("td",{width:"120"},"名称",-1))),D=d((()=>(0,s._)("td",null,"操作",-1))),y=(0,s.Uk)("设置权限"),Z=(0,s.Uk)("修改权限"),x={key:2},W=(0,s.Uk)("添 加"),U=(0,s.Uk)("保 存"),z=(0,s.Uk)("是否删除已选择数据？"),S=(0,s.Uk)("彻底删除"),I=(0,s.Uk)("更 新");function P(e,t,l,d,w,u){const P=(0,s.up)("wm-input"),T=(0,s.up)("wm-button"),F=(0,s.up)("wm-table-title"),H=(0,s.up)("wm-tag"),K=(0,s.up)("wm-popover"),Y=(0,s.up)("wm-table-tr"),L=(0,s.up)("wm-table"),j=(0,s.up)("wm-page"),q=(0,s.up)("wm-main"),J=(0,s.up)("wm-form-item"),N=(0,s.up)("wm-form"),O=(0,s.up)("wm-dialog"),R=(0,s.up)("wm-row"),$=(0,s.up)("wm-tree");return(0,s.wg)(),(0,s.iD)("div",c,[(0,s.wy)((0,s._)("div",o,[(0,s._)("div",n,[r,(0,s._)("span",{onClick:t[0]||(t[0]=t=>e.state.menuSea=!1)},h)]),(0,s._)("ul",m,[(0,s._)("li",null,[(0,s.Wm)(P,{value:e.sea.form.name,"onUpdate:value":t[1]||(t[1]=t=>e.sea.form.name=t),maxlength:"16",placeholder:"角色名称"},null,8,["value"])])]),(0,s._)("div",p,[(0,s.Wm)(T,{onClick:t[2]||(t[2]=t=>e.subSea()),height:"32px"},{default:(0,s.w5)((()=>[k])),_:1})])],512),[[a.F8,e.state.menuSea]]),(0,s._)("div",{class:"app_ct_right",style:(0,i.j5)({width:e.state.menuSea?"calc(100% - 240px)":"100%"})},[(0,s._)("div",_,[(0,s.wy)((0,s._)("div",{class:"app_action_sea",onClick:t[3]||(t[3]=t=>e.state.menuSea=!0)},g,512),[[a.F8,!e.state.menuSea]]),(0,s._)("ul",f,[e.getters.actionShow("add")?((0,s.wg)(),(0,s.iD)("li",{key:0,onClick:t[4]||(t[4]=t=>e.add.show=!0)},"添加")):(0,s.kq)("",!0),e.getters.actionShow("edit")?((0,s.wg)(),(0,s.iD)("li",{key:1,onClick:t[5]||(t[5]=t=>e.editData())},"编辑")):(0,s.kq)("",!0),e.getters.actionShow("del")?((0,s.wg)(),(0,s.iD)("li",{key:2,onClick:t[6]||(t[6]=t=>e.delData())},"删除")):(0,s.kq)("",!0)])]),(0,s._)("div",b,[(0,s.Wm)(q,null,{default:(0,s.w5)((()=>[(0,s.Wm)(L,{class:"table",ref:"Table",data:e.page.list},{default:(0,s.w5)((()=>[(0,s.Wm)(F,null,{default:(0,s.w5)((()=>[v,C,D])),_:1}),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.page.list,((t,l)=>((0,s.wg)(),(0,s.j4)(Y,{key:l,value:t.id+""},{default:(0,s.w5)((()=>[(0,s._)("td",null,(0,i.zw)(t.id),1),(0,s._)("td",null,[(0,s.Wm)(K,{type:"bottom",effect:"dark",width:"180px"},{body:(0,s.w5)((()=>[(0,s._)("p",null,"创建: "+(0,i.zw)(t.ctime||"无"),1),(0,s._)("p",null,"更新: "+(0,i.zw)(t.utime||"无"),1)])),reference:(0,s.w5)((()=>[(0,s.Wm)(H,{size:"medium"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(t.name),1)])),_:2},1024)])),_:2},1024)]),(0,s._)("td",null,[e.getters.actionShow("perm")&&!t.perm?((0,s.wg)(),(0,s.j4)(T,{key:0,type:"danger",height:"32px",onClick:l=>e.permData(t.id,t.perm)},{default:(0,s.w5)((()=>[y])),_:2},1032,["onClick"])):e.getters.actionShow("perm")?((0,s.wg)(),(0,s.j4)(T,{key:1,height:"32px",onClick:l=>e.permData(t.id,t.perm)},{default:(0,s.w5)((()=>[Z])),_:2},1032,["onClick"])):((0,s.wg)(),(0,s.iD)("span",x,"-"))])])),_:2},1032,["value"])))),128))])),_:1},8,["data"]),(0,s.Wm)(j,{page:e.page.page,limit:e.page.limit,total:e.page.total,"onUpdate:page":e.subPage},null,8,["page","limit","total","onUpdate:page"])])),_:1})])],4),(0,s.Wm)(O,{title:"添加",width:"420px",show:e.add.show,"onUpdate:close":t[9]||(t[9]=t=>e.add.show=t)},{footer:(0,s.w5)((()=>[(0,s.Wm)(T,{onClick:t[8]||(t[8]=t=>e.subAdd())},{default:(0,s.w5)((()=>[W])),_:1})])),default:(0,s.w5)((()=>[(0,s.Wm)(N,{class:"form"},{default:(0,s.w5)((()=>[(0,s.Wm)(J,{label:"名称"},{default:(0,s.w5)((()=>[(0,s.Wm)(P,{value:e.add.form.name,"onUpdate:value":t[7]||(t[7]=t=>e.add.form.name=t),maxlength:"16",placeholder:"角色名称"},null,8,["value"])])),_:1})])),_:1})])),_:1},8,["show"]),(0,s.Wm)(O,{title:"编辑",width:"420px",show:e.edit.show,"onUpdate:close":t[12]||(t[12]=t=>e.edit.show=t)},{footer:(0,s.w5)((()=>[(0,s.Wm)(T,{onClick:t[11]||(t[11]=t=>e.subEdit())},{default:(0,s.w5)((()=>[U])),_:1})])),default:(0,s.w5)((()=>[(0,s.Wm)(N,{class:"form"},{default:(0,s.w5)((()=>[(0,s.Wm)(J,{label:"名称"},{default:(0,s.w5)((()=>[(0,s.Wm)(P,{value:e.edit.form.name,"onUpdate:value":t[10]||(t[10]=t=>e.edit.form.name=t),maxlength:"16",placeholder:"角色名称"},null,8,["value"])])),_:1})])),_:1})])),_:1},8,["show"]),(0,s.Wm)(O,{title:"删除",width:"320px",show:e.del.show,"onUpdate:close":t[14]||(t[14]=t=>e.del.show=t)},{footer:(0,s.w5)((()=>[(0,s.Wm)(T,{onClick:t[13]||(t[13]=t=>e.subDel())},{default:(0,s.w5)((()=>[S])),_:1})])),default:(0,s.w5)((()=>[(0,s.Wm)(R,null,{default:(0,s.w5)((()=>[z])),_:1})])),_:1},8,["show"]),(0,s.Wm)(O,{title:"权限",width:"540px",show:e.perm.show,"onUpdate:close":t[16]||(t[16]=t=>e.perm.show=t)},{footer:(0,s.w5)((()=>[(0,s.Wm)(T,{onClick:t[15]||(t[15]=t=>e.subPerm())},{default:(0,s.w5)((()=>[I])),_:1})])),default:(0,s.w5)((()=>[(0,s.Wm)($,{ref:"perm",data:e.perm.permList},null,8,["data"])])),_:1},8,["show"])])}var T=l(3907),F=l(8907),H=l(6492),K=l(5783),Y=l(2367),L=l(5219),j=l(1566),q=l(8298),J=l(9504),N=l(9876),O=l(5488),R=l(5342),$=l(7491),A=l(6675),E=l(7685),B=l(6173),M=l(3331),V=l(8896),G=l(1126),Q=(0,s.aZ)({components:{wmMain:L.Z,wmRow:j.Z,wmTable:q.Z,wmTableTitle:J.Z,wmTableTr:N.Z,wmTag:O.Z,wmPopover:R.Z,wmDialog:$.Z,wmForm:A.Z,wmFormItem:E.Z,wmInput:B.Z,wmButton:M.Z,wmPage:V.Z,wmTree:G.Z},data(){const e=(0,T.oR)(),t=e.state,l=e.getters,s={list:[],page:1,limit:10,total:0},a={show:!1,form:{}},i={show:!1,form:{}},d={show:!1,id:"",form:{}},c={show:!1,ids:""},o={show:!1,id:"",perm:"",permList:[]};return{state:t,getters:l,page:s,sea:a,add:i,edit:d,del:c,perm:o}},mounted(){Y.Z.getItem("token")&&this.loadData()},methods:{loadData(){this.page.list=[],this.page.total=0;const e=(0,F.Z)();(0,K.Z)("api_role/list",{token:Y.Z.getItem("token"),page:this.page.page,limit:this.page.limit,data:JSON.stringify(this.sea.form)},(t=>{e.clear();const l=t.data;if(0!=l.code)return(0,H.Z)(l.msg);this.page.list=l.list,this.page.total=l.total}))},subPage(e){this.page.page=e,this.loadData()},subSea(){this.page.page=1,this.loadData()},subAdd(){this.add.show=!1;const e=JSON.stringify(this.add.form),t=(0,F.Z)();(0,K.Z)("api_role/add",{token:Y.Z.getItem("token"),data:e},(e=>{t.clear();const l=e.data;return 0===l.code&&this.loadData(),(0,H.Z)(l.msg)}))},editData(){const e=this.$refs.Table,t=e.getRow();if(!t)return(0,H.Z)("请选择数据!");this.edit.show=!0,this.edit.id=t.id,this.edit.form.name=t.name},subEdit(){this.edit.show=!1;const e=this.edit.id,t=JSON.stringify(this.edit.form),l=(0,F.Z)();(0,K.Z)("api_role/edit",{token:Y.Z.getItem("token"),id:e,data:t},(e=>{l.clear();const t=e.data;return 0===t.code&&this.loadData(),(0,H.Z)(t.msg)}))},delData(){const e=this.$refs.Table,t=e.getVals();if(!t)return(0,H.Z)("请选择数据!");this.del.show=!0,this.del.ids=JSON.stringify(t)},subDel(){this.del.show=!1;const e=(0,F.Z)();(0,K.Z)("api_role/del",{token:Y.Z.getItem("token"),data:this.del.ids},(t=>{e.clear();const l=t.data;return 0===l.code&&this.loadData(),(0,H.Z)(l.msg)}))},permData(e,t){this.perm.show=!0,this.perm.id=e;const l=(0,F.Z)();(0,K.Z)("api_role/permList",{token:Y.Z.getItem("token"),perm:t},(e=>{l.clear();const t=e.data;0===t.code?this.perm.permList=t.list:(0,H.Z)(t.msg)}))},subPerm(){this.perm.show=!1;const e=this.$refs.perm,t=(0,F.Z)();(0,K.Z)("api_role/perm",{token:Y.Z.getItem("token"),id:this.perm.id,perm:e.getPerms()},(e=>{t.clear();const l=e.data;return 0===l.code&&this.loadData(),(0,H.Z)(l.msg)}))}}}),X=l(3744);const ee=(0,X.Z)(Q,[["render",P],["__scopeId","data-v-20a0c673"]]);var te=ee}}]);