(self["webpackChunkwebmis_vue"]=self["webpackChunkwebmis_vue"]||[]).push([[978],{6091:function(e,t,n){var i=n(6530).PROPER,r=n(7293),a=n(1361),o="​᠎";e.exports=function(e){return r((function(){return!!a[e]()||o[e]()!==o||i&&a[e].name!==e}))}},3210:function(e,t,n){"use strict";var i=n(2109),r=n(3111).trim,a=n(6091);i({target:"String",proto:!0,forced:a("trim")},{trim:function(){return r(this)}})},2594:function(e,t,n){"use strict";n.d(t,{Z:function(){return B}});var i=n(6252),r=n(3577),a=n(9963),o=["onClick"],l={class:"wm-tree_arrow"},c=["id"],s={class:"wm-tree_label"},d=["onClick"],u={key:0,class:"wm-tree_arrow"},w={key:1,class:"wm-tree_arrow_none"},h=["id"],m={class:"wm-tree_label"},f=["onClick"],p={key:0,class:"wm-tree_arrow"},k={key:1,class:"wm-tree_arrow_none"},_=["id"],g={class:"wm-tree_label"},v=["onClick"],b={key:0,class:"wm-tree_arrow"},y={key:1,class:"wm-tree_arrow_none"},C=["id"],D={class:"wm-tree_label"},Z=["onClick"],x={key:0,class:"wm-tree_arrow"},W={key:1,class:"wm-tree_arrow_none"},U=["id"],z={class:"wm-tree_label"},I=["onClick"],S={key:0,class:"wm-tree_arrow"},P={key:1,class:"wm-tree_arrow_none"},O=["id"],F={class:"wm-tree_label"};function T(e,t,n,T,H,K){var M=(0,i.up)("wm-checkbox");return(0,i.wg)(),(0,i.iD)("div",null,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.menus,(function(t,n){return(0,i.wg)(),(0,i.iD)("div",{key:n},[(0,i._)("div",{class:"wm-tree_content",style:{"padding-left":"0px"},onClick:function(e){return t.show=!t.show}},[(0,i._)("span",l,(0,r.zw)(t.show?"-":"+"),1),(0,i._)("span",{class:"wm-tree_checkbox",id:"wm-tree_node_"+t.id},[(0,i.Wm)(M,{checked:t.checked,onClick:(0,a.iM)((function(n){return e.click(t.id,t.checked=!t.checked,t.children)}),["stop"])},null,8,["checked","onClick"])],8,c),(0,i._)("span",s,(0,r.zw)(t.label),1)],8,o),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(t.children,(function(n,o){return(0,i.wy)(((0,i.wg)(),(0,i.iD)("div",{class:"wm-tree_node",key:o},[(0,i._)("div",{class:"wm-tree_content",style:{"padding-left":"16px"},onClick:function(e){return n.show=!n.show}},[n.children&&n.children.length>0?((0,i.wg)(),(0,i.iD)("span",u,(0,r.zw)(n.show?"-":"+"),1)):((0,i.wg)(),(0,i.iD)("span",w)),(0,i._)("span",{class:"wm-tree_checkbox",id:"wm-tree_node_"+n.id},[(0,i.Wm)(M,{checked:n.checked,onClick:(0,a.iM)((function(t){return e.click(n.id,n.checked=!n.checked,n.children)}),["stop"])},null,8,["checked","onClick"])],8,h),(0,i._)("span",m,(0,r.zw)(n.label),1)],8,d),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(n.children,(function(t,o){return(0,i.wy)(((0,i.wg)(),(0,i.iD)("div",{class:"wm-tree_node",key:o},[(0,i._)("div",{class:"wm-tree_content",style:{"padding-left":"32px"},onClick:function(e){return t.show=!t.show}},[t.children&&t.children.length>0?((0,i.wg)(),(0,i.iD)("span",p,(0,r.zw)(t.show?"-":"+"),1)):((0,i.wg)(),(0,i.iD)("span",k)),(0,i._)("span",{class:"wm-tree_checkbox",id:"wm-tree_node_"+t.id},[(0,i.Wm)(M,{checked:t.checked,onClick:(0,a.iM)((function(n){return e.click(t.id,t.checked=!t.checked,t.children)}),["stop"])},null,8,["checked","onClick"])],8,_),(0,i._)("span",g,(0,r.zw)(t.label),1)],8,f),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(t.children,(function(n,o){return(0,i.wy)(((0,i.wg)(),(0,i.iD)("div",{class:"wm-tree_node",key:o},[(0,i._)("div",{class:"wm-tree_content",style:{"padding-left":"48px"},onClick:function(e){return n.show=!n.show}},[n.children&&n.children.length>0?((0,i.wg)(),(0,i.iD)("span",b,(0,r.zw)(n.show?"-":"+"),1)):((0,i.wg)(),(0,i.iD)("span",y)),(0,i._)("span",{class:"wm-tree_checkbox",id:"wm-tree_node_"+n.id},[(0,i.Wm)(M,{checked:n.checked,onClick:(0,a.iM)((function(t){return e.click(n.id,n.checked=!n.checked,n.children)}),["stop"])},null,8,["checked","onClick"])],8,C),(0,i._)("span",D,(0,r.zw)(n.label),1)],8,v),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(n.children,(function(t,o){return(0,i.wy)(((0,i.wg)(),(0,i.iD)("div",{class:"wm-tree_node",key:o},[(0,i._)("div",{class:"wm-tree_content",style:{"padding-left":"64px"},onClick:function(e){return t.show=!t.show}},[t.children&&t.children.length>0?((0,i.wg)(),(0,i.iD)("span",x,(0,r.zw)(t.show?"-":"+"),1)):((0,i.wg)(),(0,i.iD)("span",W)),(0,i._)("span",{class:"wm-tree_checkbox",id:"wm-tree_node_"+t.id},[(0,i.Wm)(M,{checked:t.checked,onClick:(0,a.iM)((function(n){return e.click(t.id,t.checked=!t.checked,t.children)}),["stop"])},null,8,["checked","onClick"])],8,U),(0,i._)("span",z,(0,r.zw)(t.label),1)],8,Z),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(t.children,(function(n,o){return(0,i.wy)(((0,i.wg)(),(0,i.iD)("div",{class:"wm-tree_node",key:o},[(0,i._)("div",{class:"wm-tree_content",style:{"padding-left":"80px"},onClick:function(e){return n.show=!n.show}},[n.children&&n.children.length>0?((0,i.wg)(),(0,i.iD)("span",S,(0,r.zw)(n.show?"-":"+"),1)):((0,i.wg)(),(0,i.iD)("span",P)),(0,i._)("span",{class:"wm-tree_checkbox",id:"wm-tree_node_"+n.id},[(0,i.Wm)(M,{checked:n.checked,onClick:(0,a.iM)((function(t){return e.click(n.id,n.checked=!n.checked,n.children)}),["stop"])},null,8,["checked","onClick"])],8,O),(0,i._)("span",F,(0,r.zw)(n.label),1)],8,I),(0,i._)("div",{class:(0,r.C_)("wm-tree_node_"+n.id)},null,2)])),[[a.F8,t.show]])})),128))])),[[a.F8,n.show]])})),128))])),[[a.F8,t.show]])})),128))])),[[a.F8,n.show]])})),128))])),[[a.F8,t.show]])})),128))])})),128))])}n(3210);var H=n(2458),K=(0,i.aZ)({name:"Tree",components:{wmCheckbox:H.Z},props:{data:{default:[]}},data:function(){var e=[],t=[],n="";return{menus:e,perms:n,arrs:t}},watch:{data:function(e){this.menus=e}},methods:{click:function(e,t,n){this.setCheckbox(e,t),n&&this.setChecked(t,n)},setChecked:function(e,t){for(var n in t)t[n].checked=e,this.setCheckbox(t[n].id,t[n].checked),t[n].children&&this.setChecked(e,t[n].children)},setCheckbox:function(e,t){var n=document.querySelector("#wm-tree_node_"+e+" .checked");n&&(t?n.classList.add("active"):n.classList.remove("active"))},getIds:function(){return this.arrs=[],this.setIds(this.menus),this.arrs},setIds:function(e){for(var t in e)e[t].children&&this.setIds(e[t].children),e[t].checked&&this.arrs.push(e[t].id)},getPerms:function(){return this.perms="",this.setPerms(this.menus),this.perms.trim()},setPerms:function(e){for(var t in e){var n=0;if(e[t].action)for(var i in e[t].children)e[t].children[i].checked&&(n+=parseInt(e[t].children[i].perm));else e[t].children&&this.setPerms(e[t].children);e[t].checked&&(this.perms+=e[t].id+":"+n+" ")}}}}),M=n(3744);const Y=(0,M.Z)(K,[["render",T],["__scopeId","data-v-4532217d"]]);var B=Y},9379:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return ne}});n(8309);var i=n(6252),r=n(9963),a=n(3577),o={class:"flex"},l={class:"app_ct_left"},c={class:"app_action_body flex_left"},s=(0,i._)("i",{class:"ui ui_search"},null,-1),d=[s],u={class:"app_action_list flex_left"},w={class:"app_ct_body"},h={width:"60"},m=(0,i.Uk)("ID"),f={width:"100"},p=(0,i.Uk)("名称"),k={width:"140"},_=(0,i.Uk)("创建时间"),g={width:"140"},v=(0,i.Uk)("更新时间"),b=(0,i._)("td",{width:"60",class:"tCenter"},"权限",-1),y=(0,i._)("td",null,"权限值",-1),C={width:"30",class:"checkbox wm-table_checkbox"},D={class:"tCenter"},Z=(0,i.Uk)("设置"),x=(0,i.Uk)("编辑"),W={key:2},U=(0,i._)("td",{class:"lable"},"名称",-1),z=(0,i.Uk)("添 加"),I=(0,i._)("td",{class:"lable"},"名称",-1),S=(0,i.Uk)("保 存"),P=(0,i.Uk)("是否删除已选择数据？"),O=(0,i.Uk)("彻底删除"),F=(0,i.Uk)("更 新");function T(e,t,n,s,T,H){var K=(0,i.up)("wm-input"),M=(0,i.up)("wm-search"),Y=(0,i.up)("wm-table-order"),B=(0,i.up)("wm-checkbox"),L=(0,i.up)("wm-button"),R=(0,i.up)("wm-table"),q=(0,i.up)("wm-page"),J=(0,i.up)("wm-main"),N=(0,i.up)("wm-table-form"),j=(0,i.up)("wm-dialog"),E=(0,i.up)("wm-row"),$=(0,i.up)("wm-tree");return(0,i.wg)(),(0,i.iD)("div",o,[(0,i.wy)((0,i._)("div",l,[(0,i.Wm)(M,{show:e.sea.show,"onUpdate:show":t[1]||(t[1]=function(t){return e.sea.show=t}),"onUpdate:submit":t[2]||(t[2]=function(t){return e.subSea()})},{default:(0,i.w5)((function(){return[(0,i._)("li",null,[(0,i.Wm)(K,{value:e.sea.form.name,"onUpdate:value":t[0]||(t[0]=function(t){return e.sea.form.name=t}),maxlength:"16",placeholder:"角色名称",clearable:""},null,8,["value"])])]})),_:1},8,["show"])],512),[[r.F8,e.sea.show]]),(0,i._)("div",{class:"app_ct_right",style:(0,a.j5)({width:e.sea.show?"calc(100% - 240px)":"100%"})},[(0,i._)("div",c,[(0,i.wy)((0,i._)("div",{class:"app_action_sea",onClick:t[3]||(t[3]=function(t){return e.sea.show=!0})},d,512),[[r.F8,!e.sea.show]]),(0,i._)("ul",u,[e.getters.actionShow("add")?((0,i.wg)(),(0,i.iD)("li",{key:0,onClick:t[4]||(t[4]=function(t){return e.add.show=!0})},"添加")):(0,i.kq)("",!0),e.getters.actionShow("edit")?((0,i.wg)(),(0,i.iD)("li",{key:1,onClick:t[5]||(t[5]=function(t){return e.editData()})},"编辑")):(0,i.kq)("",!0),e.getters.actionShow("del")?((0,i.wg)(),(0,i.iD)("li",{key:2,onClick:t[6]||(t[6]=function(t){return e.delData()})},"删除")):(0,i.kq)("",!0)])]),(0,i._)("div",w,[(0,i.Wm)(J,null,{default:(0,i.w5)((function(){return[(0,i.Wm)(R,{ref:"Table",data:e.page.list},{title:(0,i.w5)((function(){return[(0,i._)("td",h,[m,(0,i.Wm)(Y,{value:e.oby.list.id,"onUpdate:value":t[7]||(t[7]=function(t){return e.OrderBy("id",t)})},null,8,["value"])]),(0,i._)("td",f,[p,(0,i.Wm)(Y,{value:e.oby.list.name,"onUpdate:value":t[8]||(t[8]=function(t){return e.OrderBy("name",t)})},null,8,["value"])]),(0,i._)("td",k,[_,(0,i.Wm)(Y,{value:e.oby.list.ctime,"onUpdate:value":t[9]||(t[9]=function(t){return e.OrderBy("ctime",t)})},null,8,["value"])]),(0,i._)("td",g,[v,(0,i.Wm)(Y,{value:e.oby.list.utime,"onUpdate:value":t[10]||(t[10]=function(t){return e.OrderBy("utime",t)})},null,8,["value"])]),b,y]})),default:(0,i.w5)((function(){return[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.page.list,(function(t,n){return(0,i.wg)(),(0,i.iD)("tr",{key:n},[(0,i._)("td",C,[(0,i.Wm)(B,{value:t.id},null,8,["value"])]),(0,i._)("td",null,(0,a.zw)(t.id),1),(0,i._)("td",null,[(0,i._)("b",null,(0,a.zw)(t.name),1)]),(0,i._)("td",null,(0,a.zw)(t.ctime),1),(0,i._)("td",null,(0,a.zw)(t.utime),1),(0,i._)("td",D,[e.getters.actionShow("perm")&&!t.perm?((0,i.wg)(),(0,i.j4)(L,{key:0,type:"text",textColor:"danger",onClick:function(n){return e.permData(t.id,t.perm)}},{default:(0,i.w5)((function(){return[Z]})),_:2},1032,["onClick"])):e.getters.actionShow("perm")?((0,i.wg)(),(0,i.j4)(L,{key:1,type:"text",onClick:function(n){return e.permData(t.id,t.perm)}},{default:(0,i.w5)((function(){return[x]})),_:2},1032,["onClick"])):((0,i.wg)(),(0,i.iD)("span",W,"-"))]),(0,i._)("td",null,(0,a.zw)(t.perm),1)])})),128))]})),_:1},8,["data"]),(0,i.Wm)(q,{page:e.page.page,limit:e.page.limit,total:e.page.total,"onUpdate:page":e.subPage},null,8,["page","limit","total","onUpdate:page"])]})),_:1})])],4),(0,i.Wm)(j,{title:"添加",width:"420px",show:e.add.show,"onUpdate:show":t[13]||(t[13]=function(t){return e.add.show=t})},{footer:(0,i.w5)((function(){return[(0,i.Wm)(L,{onClick:t[12]||(t[12]=function(t){return e.subAdd()})},{default:(0,i.w5)((function(){return[z]})),_:1})]})),default:(0,i.w5)((function(){return[(0,i.Wm)(N,null,{default:(0,i.w5)((function(){return[(0,i._)("tr",null,[U,(0,i._)("td",null,[(0,i.Wm)(K,{value:e.add.form.name,"onUpdate:value":t[11]||(t[11]=function(t){return e.add.form.name=t}),maxlength:"16",placeholder:"角色名称"},null,8,["value"])])])]})),_:1})]})),_:1},8,["show"]),(0,i.Wm)(j,{title:"编辑",width:"420px",show:e.edit.show,"onUpdate:show":t[16]||(t[16]=function(t){return e.edit.show=t})},{footer:(0,i.w5)((function(){return[(0,i.Wm)(L,{onClick:t[15]||(t[15]=function(t){return e.subEdit()})},{default:(0,i.w5)((function(){return[S]})),_:1})]})),default:(0,i.w5)((function(){return[(0,i.Wm)(N,null,{default:(0,i.w5)((function(){return[(0,i._)("tr",null,[I,(0,i._)("td",null,[(0,i.Wm)(K,{value:e.edit.form.name,"onUpdate:value":t[14]||(t[14]=function(t){return e.edit.form.name=t}),maxlength:"16",placeholder:"角色名称"},null,8,["value"])])])]})),_:1})]})),_:1},8,["show"]),(0,i.Wm)(j,{title:"删除",width:"360px",show:e.del.show,"onUpdate:show":t[18]||(t[18]=function(t){return e.del.show=t})},{footer:(0,i.w5)((function(){return[(0,i.Wm)(L,{onClick:t[17]||(t[17]=function(t){return e.subDel()})},{default:(0,i.w5)((function(){return[O]})),_:1})]})),default:(0,i.w5)((function(){return[(0,i.Wm)(E,null,{default:(0,i.w5)((function(){return[P]})),_:1})]})),_:1},8,["show"]),(0,i.Wm)(j,{title:"权限",width:"540px",show:e.perm.show,"onUpdate:show":t[20]||(t[20]=function(t){return e.perm.show=t})},{footer:(0,i.w5)((function(){return[(0,i.Wm)(L,{onClick:t[19]||(t[19]=function(t){return e.subPerm()})},{default:(0,i.w5)((function(){return[F]})),_:1})]})),default:(0,i.w5)((function(){return[(0,i.Wm)($,{ref:"perm",data:e.perm.permList},null,8,["data"])]})),_:1},8,["show"])])}n(8862);var H=n(3907),K=n(8907),M=n(6492),Y=n(5783),B=n(2367),L=n(8408),R=n(6448),q=n(1566),J=n(3576),N=n(4598),j=n(3098),E=n(2458),$=n(5171),A=n(3826),V=n(8650),G=n(6457),Q=n(2594),X=(0,i.aZ)({components:{wmSearch:L.Z,wmMain:R.Z,wmRow:q.Z,wmTable:J.Z,wmTableForm:N.Z,wmTableOrder:j.Z,wmCheckbox:E.Z,wmDialog:$.Z,wmInput:A.Z,wmButton:V.Z,wmPage:G.Z,wmTree:Q.Z},data:function(){var e=(0,H.oR)(),t=e.state,n=e.getters,i={list:[],page:1,limit:20,total:0},r={show:!1,form:{}},a={name:"",list:{id:"",name:"",ctime:"",utime:""}},o={show:!1,form:{}},l={show:!1,id:"",form:{}},c={show:!1,ids:""},s={show:!1,id:"",perm:"",permList:[]};return{state:t,getters:n,page:i,sea:r,oby:a,add:o,edit:l,del:c,perm:s}},mounted:function(){B.Z.getItem("token")&&this.loadData()},methods:{loadData:function(){var e=this;this.page.list=[],this.page.total=0;var t=(0,K.Z)();(0,Y.Z)("api_role/list",{token:B.Z.getItem("token"),page:this.page.page,limit:this.page.limit,data:JSON.stringify(this.sea.form),order:this.oby.name},(function(n){t.clear();var i=n.data;if(0!=i.code)return(0,M.Z)(i.msg);e.page.list=i.list,e.page.total=i.total}))},subPage:function(e){this.page.page=e,this.loadData()},subSea:function(){this.page.page=1,this.loadData()},OrderBy:function(e,t){for(var n in this.oby.list)this.oby.list[n]=n==e?t:"";this.oby.name=t?e+" "+t:"",this.loadData()},subAdd:function(){var e=this;this.add.show=!1;var t=JSON.stringify(this.add.form),n=(0,K.Z)();(0,Y.Z)("api_role/add",{token:B.Z.getItem("token"),data:t},(function(t){n.clear();var i=t.data;return 0===i.code&&e.loadData(),(0,M.Z)(i.msg)}))},editData:function(){var e=this.$refs.Table,t=e.getRow();if(!t)return(0,M.Z)("请选择数据!");this.edit.show=!0,this.edit.id=t.id,this.edit.form.name=t.name},subEdit:function(){var e=this;this.edit.show=!1;var t=this.edit.id,n=JSON.stringify(this.edit.form),i=(0,K.Z)();(0,Y.Z)("api_role/edit",{token:B.Z.getItem("token"),id:t,data:n},(function(t){i.clear();var n=t.data;return 0===n.code&&e.loadData(),(0,M.Z)(n.msg)}))},delData:function(){var e=this.$refs.Table,t=e.getVals();if(!t)return(0,M.Z)("请选择数据!");this.del.show=!0,this.del.ids=JSON.stringify(t)},subDel:function(){var e=this;this.del.show=!1;var t=(0,K.Z)();(0,Y.Z)("api_role/del",{token:B.Z.getItem("token"),data:this.del.ids},(function(n){t.clear();var i=n.data;return 0===i.code&&e.loadData(),(0,M.Z)(i.msg)}))},permData:function(e,t){var n=this;this.perm.show=!0,this.perm.id=e;var i=(0,K.Z)();(0,Y.Z)("api_role/permList",{token:B.Z.getItem("token"),perm:t||""},(function(e){i.clear();var t=e.data;0===t.code?n.perm.permList=t.list:(0,M.Z)(t.msg)}))},subPerm:function(){var e=this;this.perm.show=!1;var t=this.$refs.perm,n=(0,K.Z)();(0,Y.Z)("api_role/perm",{token:B.Z.getItem("token"),id:this.perm.id,perm:t.getPerms()},(function(t){n.clear();var i=t.data;return 0===i.code&&e.loadData(),(0,M.Z)(i.msg)}))}}}),ee=n(3744);const te=(0,ee.Z)(X,[["render",T]]);var ne=te}}]);